# 手动测试指南

## 快速开始

### 1. 编译程序
```bash
cd /Users/zhouzhilin/Documents/git_repo/cs3331_lab/ItemRecovery
make clean
make
```

### 2. 运行程序
```bash
make run
# 或者
./output/main
```

程序启动后会显示主窗口界面。

---

## 完整测试流程

### 测试场景 1：管理员登录和基本功能

#### 步骤 1.1：管理员登录
1. 点击右上角的 **"登录/注册"** 按钮
2. 在登录对话框中输入：
   - 用户名：`admin`
   - 密码：`admin123`
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"登录成功！"消息框
   - 右上角显示"当前用户: admin [管理员]"
   - 状态显示"状态: 已登录"
   - 所有功能按钮变为可用状态
   - "管理员功能"按钮可用

#### 步骤 1.2：查看物品列表
1. 观察左侧物品列表
2. **预期结果**：
   - 初始状态列表为空（或显示已有物品）
   - 列表显示格式为："物品名称 - [类型名称]"

#### 步骤 1.3：添加物品
1. 点击 **"添加物品"** 按钮
2. 在对话框中填写：
   - 物品名称：`测试笔记本电脑`
   - 物品说明：`高性能游戏本，配置良好`
   - 物品地址：`宿舍A栋101`
   - 物品类型：选择 `其他`（从下拉列表）
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"物品添加成功！"消息框
   - 左侧物品列表中出现新物品："测试笔记本电脑 - [其他]"
   - 联系人信息自动使用管理员信息

#### 步骤 1.4：查看物品详情
1. 在左侧物品列表中点击刚才添加的物品
2. **预期结果**：
   - 右侧详情区域显示：
     - 物品名称：测试笔记本电脑
     - 物品说明：高性能游戏本，配置良好
     - 物品地址：宿舍A栋101
     - 物品类型：其他
     - 类型属性：（如果有）
     - 联系人信息：admin 的联系信息

#### 步骤 1.5：添加更多物品（测试不同类型）
1. 点击 **"添加物品"**
2. 添加一个"食品"类型的物品：
   - 物品名称：`苹果`
   - 物品说明：`新鲜苹果，保质期3天`
   - 物品地址：`宿舍B栋201`
   - 物品类型：选择 `食品`
3. 点击 **"确定"**
4. **预期结果**：
   - 添加成功
   - 列表显示："苹果 - [食品]"
   - 点击查看详情时，类型属性显示：保质期（字符串）、数量（整数）

---

### 测试场景 2：搜索功能

#### 步骤 2.1：按类型搜索
1. 点击 **"搜索物品"** 按钮
2. 在搜索对话框中：
   - 搜索关键字：`电脑`
   - 物品类型：选择 `其他`（不是"全部类型"）
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"找到 X 个匹配的物品"消息框
   - 物品列表中"测试笔记本电脑"被高亮选中
   - 右侧自动显示该物品的详情

#### 步骤 2.2：搜索所有类型
1. 点击 **"搜索物品"** 按钮
2. 在搜索对话框中：
   - 搜索关键字：`宿舍`
   - 物品类型：选择 `全部类型`
3. 点击 **"确定"**
4. **预期结果**：
   - 显示找到所有包含"宿舍"关键字的物品
   - 匹配的物品被高亮显示
   - 关键字会在物品名称、说明、联系人名称中匹配

#### 步骤 2.3：搜索无结果
1. 点击 **"搜索物品"** 按钮
2. 输入：
   - 搜索关键字：`不存在的物品`
   - 物品类型：`全部类型`
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"未找到匹配的物品"消息框

---

### 测试场景 3：管理员功能 - 物品类型管理

#### 步骤 3.1：打开管理员功能
1. 确保已以管理员身份登录
2. 点击 **"管理员功能"** 按钮
3. **预期结果**：
   - 打开管理员功能对话框
   - 显示两个标签页："物品类型管理" 和 "用户审批"
   - "物品类型管理"标签页显示所有默认类型

#### 步骤 3.2：查看物品类型列表
1. 在"物品类型管理"标签页中查看列表
2. **预期结果**：
   - 显示默认类型：食品、书籍、工具、其他
   - 每个类型显示其属性信息，格式如："食品 [属性: 保质期, 数量]"

#### 步骤 3.3：添加新物品类型
1. 点击 **"添加类型"** 按钮
2. 输入类型名称：`电子产品`
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"物品类型添加成功！"消息框
   - 类型列表中出现新类型："电子产品 [属性: ]"（无属性）

#### 步骤 3.4：为类型添加属性
1. 在类型列表中点击刚才添加的"电子产品"
2. 点击 **"添加属性"** 按钮
3. 输入属性名称：`品牌`
4. 选择属性类型：`字符串`
5. 点击 **"确定"**
6. **预期结果**：
   - 显示"属性添加成功！"消息框
   - 类型列表更新为："电子产品 [属性: 品牌]"

7. 再次点击 **"添加属性"**，添加：
   - 属性名称：`价格`
   - 属性类型：`浮点数`
8. **预期结果**：
   - 类型列表显示："电子产品 [属性: 品牌, 价格]"

#### 步骤 3.5：修改属性
1. 在类型列表中点击"电子产品"
2. 点击 **"修改属性"** 按钮
3. 在属性列表中选择：`品牌 (字符串)`
4. 输入新属性名称：`生产厂商`
5. 选择新属性类型：`字符串`
6. 点击 **"确定"**
7. **预期结果**：
   - 显示"属性修改成功！"消息框
   - 类型列表更新为："电子产品 [属性: 生产厂商, 价格]"

#### 步骤 3.6：删除属性
1. 在类型列表中点击"电子产品"
2. 点击 **"删除属性"** 按钮
3. 在属性列表中选择：`价格 (浮点数)`
4. 在确认对话框中选择 **"是"**
5. **预期结果**：
   - 显示"属性删除成功！"消息框
   - 类型列表更新为："电子产品 [属性: 生产厂商]"

#### 步骤 3.7：使用新类型添加物品
1. 关闭管理员功能对话框
2. 点击 **"添加物品"** 按钮
3. 填写：
   - 物品名称：`iPhone 15`
   - 物品说明：`全新未拆封`
   - 物品地址：`宿舍C栋301`
   - 物品类型：选择 `电子产品`
4. 点击 **"确定"**
5. **预期结果**：
   - 添加成功
   - 查看详情时，类型属性显示："生产厂商 (字符串)"

---

### 测试场景 4：用户注册和审批

#### 步骤 4.1：退出管理员登录
1. 点击 **"退出登录"** 按钮
2. **预期结果**：
   - 显示"已退出登录"消息框
   - 用户信息显示"未登录"
   - 所有功能按钮变为禁用状态（除了"登录/注册"）

#### 步骤 4.2：注册新用户
1. 点击 **"登录/注册"** 按钮
2. 点击 **"切换到注册"** 按钮
3. 填写注册信息：
   - 用户名：`testuser`
   - 密码：`testpass123`
   - 住址：`测试地址123号`
   - 电话：`13800000000`
   - 邮箱：`testuser@example.com`
4. 点击 **"确定"**
5. **预期结果**：
   - 显示"注册成功！请等待管理员审批。"消息框
   - 对话框关闭

#### 步骤 4.3：尝试登录（未批准）
1. 点击 **"登录/注册"** 按钮
2. 输入：
   - 用户名：`testuser`
   - 密码：`testpass123`
3. 点击 **"确定"**
4. **预期结果**：
   - 显示"您的账户尚未被管理员批准，请等待审批。"警告消息框
   - 登录失败

#### 步骤 4.4：管理员审批用户
1. 以管理员身份登录（admin/admin123）
2. 点击 **"管理员功能"** 按钮
3. 切换到 **"用户审批"** 标签页
4. **预期结果**：
   - 用户列表中显示：`testuser [普通用户] - 待审批`

5. 在用户列表中点击 `testuser` 这一行
6. 点击 **"批准选中用户"** 按钮
7. **预期结果**：
   - 显示"用户批准成功！"消息框
   - 用户列表更新为：`testuser [普通用户] - 已批准`

#### 步骤 4.5：普通用户登录
1. 退出管理员登录
2. 点击 **"登录/注册"** 按钮
3. 输入：
   - 用户名：`testuser`
   - 密码：`testpass123`
4. 点击 **"确定"**
5. **预期结果**：
   - 显示"登录成功！"消息框
   - 右上角显示"当前用户: testuser [普通用户]"
   - 功能按钮可用（但"管理员功能"按钮不可用）

#### 步骤 4.6：普通用户添加物品
1. 点击 **"添加物品"** 按钮
2. 填写：
   - 物品名称：`二手自行车`
   - 物品说明：`8成新，功能完好`
   - 物品地址：`宿舍D栋401`
   - 物品类型：选择 `工具`
3. 点击 **"确定"**
4. **预期结果**：
   - 添加成功
   - 查看详情时，联系人信息显示 testuser 的信息

#### 步骤 4.7：普通用户尝试访问管理员功能
1. 点击 **"管理员功能"** 按钮
2. **预期结果**：
   - 显示"您没有管理员权限！"警告消息框
   - 管理员功能对话框不打开

---

### 测试场景 5：删除功能

#### 步骤 5.1：删除物品
1. 在物品列表中点击任意一个物品（如"测试笔记本电脑"）
2. 点击 **"删除物品"** 按钮
3. **预期结果**：
   - 显示"物品删除成功！"消息框
   - 物品从列表中消失
   - 右侧详情区域清空

#### 步骤 5.2：尝试删除不存在的物品
1. 确保没有选中任何物品
2. 点击 **"删除物品"** 按钮
3. **预期结果**：
   - 显示"请选择要删除的物品！"警告消息框

---

### 测试场景 6：边界情况测试

#### 步骤 6.1：空输入测试
1. 点击 **"添加物品"** 按钮
2. 不填写任何内容，直接点击 **"确定"**
3. **预期结果**：
   - 显示"物品名称不能为空！"或类似验证消息

#### 步骤 6.2：搜索空关键字
1. 点击 **"搜索物品"** 按钮
2. 不输入关键字，直接点击 **"确定"**
3. **预期结果**：
   - 显示"请输入搜索关键字！"警告消息框

#### 步骤 6.3：未登录时操作
1. 确保已退出登录
2. 尝试点击 **"添加物品"** 按钮
3. **预期结果**：
   - 显示"请先登录！"警告消息框

#### 步骤 6.4：刷新列表
1. 添加几个物品后
2. 点击 **"刷新列表"** 按钮
3. **预期结果**：
   - 物品列表刷新显示所有物品
   - 保持当前选中状态（如果有）

---

## 测试检查清单

### 用户功能
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] 未批准用户无法登录
- [ ] 退出登录功能正常

### 物品管理
- [ ] 添加物品功能正常
- [ ] 查看物品详情功能正常
- [ ] 删除物品功能正常
- [ ] 物品列表显示正确
- [ ] 刷新列表功能正常

### 搜索功能
- [ ] 按类型搜索功能正常
- [ ] 搜索所有类型功能正常
- [ ] 搜索结果高亮显示
- [ ] 无结果时提示正确

### 管理员功能
- [ ] 管理员功能按钮权限控制正确
- [ ] 添加物品类型功能正常
- [ ] 添加属性功能正常
- [ ] 修改属性功能正常
- [ ] 删除属性功能正常
- [ ] 用户审批功能正常
- [ ] 类型列表刷新正常
- [ ] 用户列表刷新正常

### 界面交互
- [ ] 登录/注册对话框切换正常
- [ ] 所有按钮状态正确（启用/禁用）
- [ ] 消息提示正确显示
- [ ] 对话框操作流畅

### 数据一致性
- [ ] 添加的物品信息正确保存
- [ ] 物品类型和属性关联正确
- [ ] 用户信息正确关联到物品
- [ ] 删除后数据正确更新

---

## 常见问题排查

### 问题 1：程序无法启动
**解决方案**：
- 检查 Qt 库是否正确安装：`brew list qt`
- 检查编译是否成功：`ls -la output/main`
- 尝试重新编译：`make clean && make`

### 问题 2：界面显示异常
**解决方案**：
- 检查 Qt 版本兼容性
- 尝试设置环境变量：`export QT_QPA_PLATFORM=offscreen`（如果需要）

### 问题 3：功能按钮无响应
**解决方案**：
- 检查是否已登录
- 查看控制台是否有错误信息
- 确认按钮连接是否正确

### 问题 4：搜索无结果
**解决方案**：
- 确认物品列表中已有物品
- 检查关键字是否正确
- 确认选择的类型是否正确

---

## 测试报告模板

```
测试日期：___________
测试人员：___________
测试环境：___________

### 测试结果总结
- 通过的功能：___________
- 失败的功能：___________
- 发现的问题：___________

### 详细测试记录
[在此记录每个测试场景的执行结果]

### 问题报告
[记录发现的所有问题和异常行为]
```

---

## 提示

1. **建议测试顺序**：按照上述场景顺序进行测试，因为后面的测试依赖前面的结果
2. **数据清理**：每次完整测试后，可以重新启动程序以清理数据
3. **截图记录**：建议对关键操作进行截图，便于问题追踪
4. **日志查看**：如果程序有控制台输出，注意查看错误信息

祝测试顺利！

